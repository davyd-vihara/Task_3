# Тестирование веб-приложения Stellar Burgers

Проект автоматизированного тестирования веб-приложения Stellar Burgers с использованием Selenium WebDriver, Pytest и Allure.

## Структура проекта

```
Task_3/
├── tests/                    # Тесты
│   ├── __init__.py
│   ├── conftest.py          # Фикстуры Pytest (кроссбраузерность, создание пользователей)
│   ├── test_constructor.py  # Тесты основного функционала (конструктор, ингредиенты, заказы)
│   ├── test_login.py        # Тесты входа в систему
│   ├── test_order_feed.py   # Тесты ленты заказов
│   ├── test_password_recovery.py  # Тесты восстановления пароля
│   └── test_user_profile.py # Тесты личного кабинета
│
├── pages/                    # Page Object Model
│   ├── __init__.py
│   ├── base_page.py         # Базовый класс страницы
│   ├── constructor_page.py  # Страница конструктора бургеров
│   ├── login_page.py        # Страница входа
│   ├── main_page.py         # Главная страница
│   ├── order_feed_page.py   # Страница ленты заказов
│   ├── password_recovery_page.py  # Страница восстановления пароля
│   └── profile_page.py      # Страница личного кабинета
│
├── locators/                 # Локаторы элементов
│   ├── __init__.py
│   ├── base_locators.py     # Базовые локаторы
│   ├── constructor_locators.py
│   ├── login_locators.py
│   ├── main_locators.py
│   ├── order_feed_locators.py
│   ├── password_recovery_locators.py
│   └── profile_locators.py
│
├── config/                   # Конфигурация
│   ├── __init__.py
│   ├── constants.py         # Константы (таймауты, тексты, настройки браузера)
│   └── urls.py              # URL адреса
│
├── utils/                    # Утилиты
│   ├── __init__.py
│   ├── api_client.py        # API клиент для создания/удаления тестовых пользователей
│   └── driver_factory.py    # Фабрика драйверов (Chrome, Firefox)
│
├── requirements.txt         # Зависимости проекта
├── pytest.ini               # Конфигурация Pytest
└── README.md                # Документация
```

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Установите Allure (для просмотра отчетов):
```bash
# Windows (через Chocolatey)
choco install allure-commandline

# Или скачайте с https://github.com/allure-framework/allure2/releases
```

3. Настройте переменные окружения (опционально):
Создайте файл `.env` в корне проекта:
```env
BROWSER=chrome
FULLSCREEN=true
REUSE_BROWSER=false
CHROME_DRIVER_PATH=C:\WebDriver\chromedriver-win64\chromedriver.exe
FIREFOX_DRIVER_PATH=C:\WebDriver\geckodriver-v0.36.0-win64\geckodriver.exe
```

## Запуск тестов

### Базовый запуск:
```bash
# Запуск всех тестов (Chrome и Firefox)
pytest tests/ -v

# Очистка результатов Allure и запуск
if (Test-Path "allure-results") { Remove-Item -Path "allure-results\*" -Recurse -Force }; pytest tests/ -v
```

### Запуск с Allure отчетом:
```bash
# Запуск тестов (отчет генерируется автоматически)
pytest tests/ -v

# Просмотр отчета
allure serve ./allure-results

# Генерация HTML отчета
allure generate ./allure-results -o ./allure-report --clean
```

## Покрытие тестами

### ✅ Восстановление пароля
- ✅ Переход на страницу восстановления пароля по кнопке «Восстановить пароль»
- ✅ Ввод почты и клик по кнопке «Восстановить»
- ✅ Клик по кнопке показать/скрыть пароль делает поле активным — подсвечивает его

### ✅ Личный кабинет
- ✅ Переход по клику на «Личный кабинет»
- ✅ Переход в раздел «История заказов»
- ✅ Выход из аккаунта

### ✅ Основной функционал
- ✅ Переход по клику на «Конструктор»
- ✅ Переход по клику на «Лента заказов»
- ✅ Если кликнуть на ингредиент, появится всплывающее окно с деталями
- ✅ Всплывающее окно закрывается кликом по крестику
- ✅ При добавлении ингредиента в заказ, увеличивается каунтер данного ингредиента
- ✅ Залогиненный пользователь может оформить заказ

### ✅ Раздел «Лента заказов»
- ✅ Если кликнуть на заказ, откроется всплывающее окно с деталями
- ✅ Заказы пользователя из раздела «История заказов» отображаются на странице «Лента заказов»
- ✅ При создании нового заказа счётчик «Выполнено за всё время» увеличивается
- ✅ При создании нового заказа счётчик «Выполнено за сегодня» увеличивается
- ✅ После оформления заказа его номер появляется в разделе «В работе»

**Всего реализовано: 17 тестов**

## Соответствие требованиям задания

### ✅ Структура проекта
- ✅ Тесты в папке `tests/`
- ✅ Для Page Object создан отдельный пакет `pages/`
- ✅ Для каждой страницы создан отдельный класс с Page Object
- ✅ Тесты разделены по тематике или функциональности в отдельных классах
- ✅ Все элементы страниц, используемые в тестах, описаны в Page Object
- ✅ Названия классов Page Object отражают их содержимое
- ✅ Локаторы находятся в отдельном пакете `locators/` с файлами
- ✅ Названия локаторов понятны

### ✅ Функциональность
- ✅ Тесты запускаются и не падают
- ✅ Автотесты запускаются в обоих браузерах (Chrome и Firefox)
- ✅ Тесты не зависят друг от друга
- ✅ Названия тестов понятные и неизбыточные
- ✅ Тест — прежде всего проверка, а не набор действий. Каждый тест что-то проверяет
- ✅ Нужные тестовые данные создаются перед тестом и удаляются после того, как он выполнится
- ✅ Если для теста нужен тестовый юзер, он создаётся с помощью API
- ✅ Есть все тесты, которые описаны в задании (17 тестов)
- ✅ Сделан Allure-отчёт. Отчёт генерируется автоматически при запуске тестов

### ✅ Качество кода
- ✅ В проекте нет ничего лишнего (неиспользуемых зависимостей, неиспользуемых импортов, закомментированных блоков кода, файлов настроек IDE)
- ✅ Все импорты находятся в начале файлов
- ✅ Все ассерты находятся внутри Allure steps
- ✅ Строгое соблюдение принципа Page Object Model (POM)
- ✅ Все обращения к WebDriver идут через методы BasePage

## Особенности реализации

### Архитектура и паттерны

- **Page Object Model**: Все элементы страниц описаны в отдельных классах с наследованием от `BasePage`
- **Централизация работы с driver**: Все прямые обращения к `driver` вынесены в `BasePage` для переиспользования через наследование
- **Разделение локаторов**: Локаторы вынесены в отдельный пакет `locators/` для удобства поддержки
- **Кроссбраузерность**: Поддержка Chrome и Firefox через параметризацию фикстур с автоматическим запуском в обоих браузерах

### Качество кода и лучшие практики

- **Явные ожидания**: Используются только `WebDriverWait` с `expected_conditions`, без `time.sleep()`
- **Атомарность тестов**: Каждый тест проверяет одну конкретную функциональность
- **Независимость тестов**: Каждый тест независим, создает свои данные через API и очищает их после выполнения
- **Упрощенная логика**: Код упрощен, минимизированы `try/except` блоки и альтернативные пути поиска элементов
- **Allure разметка**: Все действия и проверки обернуты в `@allure.step` для детальных отчетов
- **Организация импортов**: Все импорты находятся в начале файлов
- **Чистота кода**: Нет лишних зависимостей, закомментированного кода, неиспользуемых импортов

### Отчетность и интеграция

- **Allure отчеты**: Детальные отчеты с шагами (`allure.step`) для всех действий и скриншотами при падении
- **API интеграция**: Создание и удаление тестовых пользователей через API для изоляции тестов
- **Автоматическая очистка**: Тестовые данные автоматически удаляются после выполнения тестов через фикстуры

## Конфигурация

Настройки можно изменить в `config/constants.py` или через переменные окружения (файл `.env`):

### Основные настройки:
- `BROWSER` - браузер для тестов (chrome/firefox), по умолчанию: `chrome`
- `FULLSCREEN` - полноэкранный режим (true/false), по умолчанию: `true`
- `REUSE_BROWSER` - переиспользование браузера (true/false), по умолчанию: `false`

### Пути к драйверам:
- `CHROME_DRIVER_PATH` - путь к ChromeDriver
- `FIREFOX_DRIVER_PATH` - путь к GeckoDriver

**Примечание:** Если путь к драйверу не указан или файл не существует, используется `webdriver-manager` для автоматической загрузки драйвера.

## Примечания

- Тесты используют реальный сайт https://stellarburgers.education-services.ru/
- Для работы тестов требуется стабильное интернет-соединение
- Тестовые пользователи создаются через API перед каждым тестом и автоматически удаляются после его завершения
- Все тесты атомарны и независимы друг от друга
- Кроссбраузерное тестирование реализовано через параметризацию фикстур Pytest
